{
  "description": "Sample JSON request/response structures for Excel GPT Middleware",
  "version": "1.0.0",
  "examples": {
    "authentication": {
      "description": "All requests require Azure AD authentication. The middleware handles this automatically.",
      "headers": {
        "Content-Type": "application/json",
        "x-user-id": "user@company.com"
      }
    },
    "getWorkbooks": {
      "description": "Get all accessible Excel workbooks from OneDrive and SharePoint",
      "request": {
        "method": "GET",
        "url": "/api/excel/workbooks",
        "headers": {
          "Content-Type": "application/json"
        }
      },
      "response": {
        "success": true,
        "data": {
          "workbooks": [
            {
              "id": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
              "name": "Sales_Report_2024.xlsx",
              "webUrl": "https://company.sharepoint.com/sites/team/Shared%20Documents/Sales_Report_2024.xlsx",
              "location": "SharePoint - Team Site",
              "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
              "lastModified": "2024-01-15T10:30:00Z",
              "size": 2048576
            }
          ],
          "count": 1
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "getWorksheets": {
      "description": "Get all worksheets in a specific workbook",
      "request": {
        "method": "GET",
        "url": "/api/excel/worksheets?driveId=b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd&itemId=01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU"
      },
      "response": {
        "success": true,
        "data": {
          "worksheets": [
            {
              "id": "{00000000-0001-0000-0000-000000000000}",
              "name": "Sales Data",
              "position": 0,
              "visibility": "Visible"
            },
            {
              "id": "{00000000-0001-0000-0000-000000000001}",
              "name": "Summary",
              "position": 1,
              "visibility": "Visible"
            }
          ],
          "count": 2,
          "workbookId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU"
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "readRange": {
      "description": "Read data from a specific Excel range",
      "request": {
        "method": "POST",
        "url": "/api/excel/read",
        "body": {
          "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
          "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "range": "A1:C10"
        }
      },
      "response": {
        "success": true,
        "operation": "READ_RANGE",
        "data": {
          "range": "Sales Data!A1:C10",
          "values": [
            ["Product", "Quantity", "Revenue"],
            ["Widget A", 100, 5000],
            ["Widget B", 150, 7500],
            ["Widget C", 75, 3750]
          ],
          "formulas": [
            ["Product", "Quantity", "Revenue"],
            ["Widget A", 100, "=B2*50"],
            ["Widget B", 150, "=B3*50"],
            ["Widget C", 75, "=B4*50"]
          ],
          "text": [
            ["Product", "Quantity", "Revenue"],
            ["Widget A", "100", "5000"],
            ["Widget B", "150", "7500"],
            ["Widget C", "75", "3750"]
          ],
          "dimensions": {
            "rows": 4,
            "columns": 3
          }
        },
        "metadata": {
          "workbookId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "requestedRange": "A1:C10"
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "writeRange": {
      "description": "Write data to a specific Excel range",
      "request": {
        "method": "POST",
        "url": "/api/excel/write",
        "body": {
          "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
          "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "range": "A5:C5",
          "values": [
            ["Widget D", 200, 10000]
          ]
        }
      },
      "response": {
        "success": true,
        "operation": "WRITE_RANGE",
        "data": {
          "range": "Sales Data!A5:C5",
          "values": [
            ["Widget D", 200, 10000]
          ],
          "dimensions": {
            "rows": 1,
            "columns": 3
          }
        },
        "metadata": {
          "workbookId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "requestedRange": "A5:C5",
          "cellsModified": 3
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "readTable": {
      "description": "Read data from an Excel table",
      "request": {
        "method": "POST",
        "url": "/api/excel/read-table",
        "body": {
          "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
          "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "tableName": "SalesTable"
        }
      },
      "response": {
        "success": true,
        "operation": "READ_TABLE",
        "data": {
          "table": {
            "id": "{5C28C4B8-4F35-4B58-88C6-5D7E6F8A9B0C}",
            "name": "SalesTable",
            "address": "Sales Data!A1:C10"
          },
          "headers": ["Product", "Quantity", "Revenue"],
          "rows": [
            ["Widget A", 100, 5000],
            ["Widget B", 150, 7500],
            ["Widget C", 75, 3750],
            ["Widget D", 200, 10000]
          ],
          "allValues": [
            ["Product", "Quantity", "Revenue"],
            ["Widget A", 100, 5000],
            ["Widget B", 150, 7500],
            ["Widget C", 75, 3750],
            ["Widget D", 200, 10000]
          ],
          "dimensions": {
            "rows": 5,
            "columns": 3
          }
        },
        "metadata": {
          "workbookId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "tableName": "SalesTable"
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "addTableRows": {
      "description": "Add new rows to an Excel table",
      "request": {
        "method": "POST",
        "url": "/api/excel/add-table-rows",
        "body": {
          "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
          "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "tableName": "SalesTable",
          "rows": [
            ["Widget E", 125, 6250],
            ["Widget F", 300, 15000]
          ]
        }
      },
      "response": {
        "success": true,
        "operation": "ADD_TABLE_ROWS",
        "data": {
          "rowsAdded": 2,
          "result": {
            "index": 4,
            "values": [
              ["Widget E", 125, 6250],
              ["Widget F", 300, 15000]
            ]
          }
        },
        "metadata": {
          "workbookId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
          "worksheetId": "{00000000-0001-0000-0000-000000000000}",
          "tableName": "SalesTable"
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "batchOperations": {
      "description": "Perform multiple Excel operations in a single request",
      "request": {
        "method": "POST",
        "url": "/api/excel/batch",
        "body": {
          "operations": [
            {
              "type": "read_range",
              "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
              "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
              "worksheetId": "{00000000-0001-0000-0000-000000000000}",
              "range": "A1:A10"
            },
            {
              "type": "write_range",
              "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
              "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
              "worksheetId": "{00000000-0001-0000-0000-000000000001}",
              "range": "B1:B1",
              "values": [["Updated Value"]]
            }
          ]
        }
      },
      "response": {
        "success": true,
        "operation": "BATCH_OPERATIONS",
        "data": {
          "results": [
            {
              "index": 0,
              "operation": "read_range",
              "success": true,
              "data": {
                "range": "Sales Data!A1:A10",
                "values": [["Product"], ["Widget A"], ["Widget B"], ["Widget C"]],
                "rowCount": 4,
                "columnCount": 1
              }
            },
            {
              "index": 1,
              "operation": "write_range",
              "success": true,
              "data": {
                "range": "Summary!B1:B1",
                "values": [["Updated Value"]],
                "rowCount": 1,
                "columnCount": 1
              }
            }
          ],
          "errors": [],
          "summary": {
            "total": 2,
            "successful": 2,
            "failed": 0
          }
        },
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "errorResponses": {
      "description": "Common error response formats",
      "authenticationError": {
        "error": "Authentication failed",
        "message": "Unable to authenticate with Microsoft Graph API",
        "timestamp": "2024-01-15T10:35:00Z"
      },
      "validationError": {
        "error": "Validation failed",
        "message": "Request data is invalid",
        "details": [
          {
            "field": "range",
            "message": "\"range\" is required",
            "value": null
          }
        ],
        "timestamp": "2024-01-15T10:35:00Z"
      },
      "permissionError": {
        "error": "Access denied",
        "message": "Write access denied: No write permission",
        "timestamp": "2024-01-15T10:35:00Z"
      },
      "rateLimitError": {
        "error": "Rate limit exceeded",
        "message": "Too many requests, please try again later",
        "retryAfter": 900,
        "timestamp": "2024-01-15T10:35:00Z"
      },
      "graphApiError": {
        "error": "Graph API error",
        "message": "Requested resource not found",
        "timestamp": "2024-01-15T10:35:00Z"
      }
    },
    "gptIntegrationExamples": {
      "description": "Examples of how a GPT would interact with this middleware",
      "readSalesData": {
        "gptPrompt": "Read the sales data from cells A1 to C10 in the Sales Report workbook",
        "middlewareRequest": {
          "method": "POST",
          "url": "/api/excel/read",
          "body": {
            "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
            "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
            "worksheetId": "{00000000-0001-0000-0000-000000000000}",
            "range": "A1:C10"
          }
        }
      },
      "updateInventory": {
        "gptPrompt": "Update the inventory count for Widget A to 150 in cell B2",
        "middlewareRequest": {
          "method": "POST",
          "url": "/api/excel/write",
          "body": {
            "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
            "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
            "worksheetId": "{00000000-0001-0000-0000-000000000000}",
            "range": "B2:B2",
            "values": [[150]]
          }
        }
      },
      "addNewProduct": {
        "gptPrompt": "Add a new product 'Widget G' with quantity 80 and revenue 4000 to the SalesTable",
        "middlewareRequest": {
          "method": "POST",
          "url": "/api/excel/add-table-rows",
          "body": {
            "driveId": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
            "itemId": "01BYE5RZ6QN3ZWBTUQOJFZYDG5OH6HWJKU",
            "worksheetId": "{00000000-0001-0000-0000-000000000000}",
            "tableName": "SalesTable",
            "rows": [["Widget G", 80, 4000]]
          }
        }
      }
    }
  }
}
