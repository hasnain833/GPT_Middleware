{
  "info": {
    "name": "Excel GPT Middleware API",
    "description": "Complete API collection for testing Excel operations via Microsoft Graph",
    "version": "1.0.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "noauth"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "test@yourdomain.com",
      "type": "string"
    },
    {
      "key": "driveId",
      "value": "b!-RIj2DuyvEyV1T4NlOaMHk8XkS_I8MdFlUCq1BlcjgmhRfAj3-Z8RY2VpuvV_tpd",
      "type": "string"
    },
    {
      "key": "itemId",
      "value": "01BYE5RZ6QN3ZWBTURCNF2AJFUYLRTX5PC",
      "type": "string"
    },
    {
      "key": "worksheetId",
      "value": "Sheet1",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/health",
          "host": ["{{baseUrl}}"],
          "path": ["health"]
        }
      },
      "response": []
    },
    {
      "name": "Get Workbooks",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/excel/workbooks",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "workbooks"]
        }
      },
      "response": []
    },
    {
      "name": "Get Worksheets",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/excel/worksheets?driveId={{driveId}}&itemId={{itemId}}",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "worksheets"],
          "query": [
            {
              "key": "driveId",
              "value": "{{driveId}}"
            },
            {
              "key": "itemId",
              "value": "{{itemId}}"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Read Excel Range",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"driveId\": \"{{driveId}}\",\n  \"itemId\": \"{{itemId}}\",\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"range\": \"A1:C5\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/excel/read",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "read"]
        }
      },
      "response": []
    },
    {
      "name": "Write Excel Range",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"driveId\": \"{{driveId}}\",\n  \"itemId\": \"{{itemId}}\",\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"range\": \"A1:B3\",\n  \"values\": [\n    [\"Name\", \"Age\"],\n    [\"John Doe\", 30],\n    [\"Jane Smith\", 25]\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/excel/write",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "write"]
        }
      },
      "response": []
    },
    {
      "name": "Read Excel Table",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"driveId\": \"{{driveId}}\",\n  \"itemId\": \"{{itemId}}\",\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"tableName\": \"Table1\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/excel/read-table",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "read-table"]
        }
      },
      "response": []
    },
    {
      "name": "Add Table Rows",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"driveId\": \"{{driveId}}\",\n  \"itemId\": \"{{itemId}}\",\n  \"worksheetId\": \"{{worksheetId}}\",\n  \"tableName\": \"Table1\",\n  \"rows\": [\n    [\"Alice Johnson\", 28, \"Engineer\"],\n    [\"Bob Wilson\", 35, \"Manager\"],\n    [\"Carol Davis\", 31, \"Designer\"]\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/excel/add-table-rows",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "add-table-rows"]
        }
      },
      "response": []
    },
    {
      "name": "Batch Operations",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"operations\": [\n    {\n      \"type\": \"read_range\",\n      \"driveId\": \"{{driveId}}\",\n      \"itemId\": \"{{itemId}}\",\n      \"worksheetId\": \"{{worksheetId}}\",\n      \"range\": \"A1:B2\"\n    },\n    {\n      \"type\": \"write_range\",\n      \"driveId\": \"{{driveId}}\",\n      \"itemId\": \"{{itemId}}\",\n      \"worksheetId\": \"{{worksheetId}}\",\n      \"range\": \"D1:E2\",\n      \"values\": [\n        [\"Batch\", \"Test\"],\n        [\"Success\", \"API\"]\n      ]\n    },\n    {\n      \"type\": \"read_table\",\n      \"driveId\": \"{{driveId}}\",\n      \"itemId\": \"{{itemId}}\",\n      \"worksheetId\": \"{{worksheetId}}\",\n      \"tableName\": \"Table1\"\n    }\n  ]\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/excel/batch",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "batch"]
        }
      },
      "response": []
    },
    {
      "name": "Get Audit Logs",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/excel/logs?limit=10&startDate=2024-01-01&endDate=2024-12-31",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "logs"],
          "query": [
            {
              "key": "limit",
              "value": "10"
            },
            {
              "key": "startDate",
              "value": "2024-01-01"
            },
            {
              "key": "endDate",
              "value": "2024-12-31"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Get File Metadata",
      "request": {
        "method": "GET",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          },
          {
            "key": "x-user-id",
            "value": "{{userId}}"
          }
        ],
        "url": {
          "raw": "{{baseUrl}}/api/excel/metadata?driveId={{driveId}}&itemId={{itemId}}",
          "host": ["{{baseUrl}}"],
          "path": ["api", "excel", "metadata"],
          "query": [
            {
              "key": "driveId",
              "value": "{{driveId}}"
            },
            {
              "key": "itemId",
              "value": "{{itemId}}"
            }
          ]
        }
      },
      "response": []
    }
  ]
}
